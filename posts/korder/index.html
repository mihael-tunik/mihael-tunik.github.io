<!doctype html>
<html lang="en">
    <head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content='text/html; charset=utf-8' http-equiv='content-type' />
<meta name="generator" content="Hugo 0.136.3">
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bitter&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="http://mihael-tunik.github.io/css/styles.css" rel="stylesheet">
<title>MT mini-blog</title>
<meta name="description" content="Find median of two sorted arrays in logarithmic time is quite famous interview question (and a Leetcode problem from hard category).
In this article I&rsquo;ll generalize this question and solve it with Python. Let&rsquo;s code!">
<meta name="author" content="">


<meta property="og:description" content="Find median of two sorted arrays in logarithmic time is quite famous interview question (and a Leetcode problem from hard category).
In this article I&rsquo;ll generalize this question and solve it with Python. Let&rsquo;s code!" />







<meta name="twitter:description" content="Find median of two sorted arrays in logarithmic time is quite famous interview question (and a Leetcode problem from hard category).
In this article I&rsquo;ll generalize this question and solve it with Python. Let&rsquo;s code!">


</head>
    <body>
        <div class="content">
            <nav class="blog-navigation">
  <div class="left">
      <div class="blog-logo">
        <a href='/' title="MT mini-blog">
          <img src="http://mihael-tunik.github.io/img/logo.svg" alt="MT mini-blog">
        </a>
      </div>
      <div class="blog-info">
          <div class="blog-title">
            <a href='/' title="MT mini-blog">
              <h1>MT mini-blog</h1>
            </a>
          </div>
          <div class="blog-description">
            <a href='/' title="MT mini-blog">
              <h2>Things around computer science</h2>
            </a>
          </div>
      </div>
  </div>
  <div class="right">
    <div class="blog-links">
      <ul class="links">
          <li class="item social"><a href='https://github.com/mihael-tunik' title="Github" target="_blank">Github</a></li>
      </ul>
    </div>
  </div>
</nav>
<div class="single">
    <article>
        <div class="article-meta">
    <ul class="article-info">
        <li class="time" style="">
            <time class="time">14 Jul 2024</time>
        </li>
        <li class="reading-time" style="">
            <span class="material-icons">timer</span>6 min read
        </li>
        <li class="words-count" style="">
            <span class="material-icons">article</span>1123 words
        </li>
    </ul>
    <ul class="article-tags" style="">
                <li>
                    <a href='/tags/algorithms'>#algorithms</a>
                </li>
                <li>
                    <a href='/tags/medium'>#medium</a>
                </li>
                <li>
                    <a href='/tags/tutorials'>#tutorials</a>
                </li>
                <li>
                    <a href='/tags/python'>#python</a>
                </li>
    </ul>
</div>
        <div class="article-header">
            <h1 class="article-title">K order statistics in two sorted arrays</h1>          
            <h2 class="article-excerpt"></h2>  
        </div>
        <div class="article-content">
            <p>Find median of two sorted arrays in logarithmic time is quite famous interview question (and a Leetcode problem from <em>hard</em> category).
In this article I&rsquo;ll generalize this question and solve it with Python. Let&rsquo;s code!</p>
<h2 id="median-in-two-sorted-arrays">Median in two sorted arrays</h2>
<p>First, let&rsquo;s define first problem:</p>
<blockquote>
<p>Given two integer arrays (sorted in ascending order) find <strong>median</strong> value of merged array.</p>
</blockquote>
<p>Reminder: median is central element in odd case and average of central elements in even case.
This question is not a big deal, when you&rsquo;re not limited by computational complexity.
For example, two sorted arrays can be merged in O(n) and then median value can be returned in O(1).</p>
<p>Because of that, classic version of the problem includes condition that it should be solved in <em>logarithmic time</em>
and that makes things more interesting.</p>
<h2 id="k-order-static-in-two-sorted-arrays">K order static in two sorted arrays</h2>
<p>Now, let&rsquo;s state a little more general question:
to find k-th element in two sorted arrays.</p>
<blockquote>
<p>Given two integer arrays (sorted in ascending order) find <strong>k order</strong> value of merged array.</p>
</blockquote>
<p>This looks kind of the same with one subtle difference, that k order statistic is always element of array.
So, arrays are <em>sorted</em> and we want <em>to find</em> some special element in logarithmic time.
This gives us a hint that probably some binary search variation should be involved.</p>
<p>Indeed, we can search for element <em>x[j]</em>, such as it is larger than <em>f(j) = k - j</em> elements in <em>y</em>.
If such element exists it&rsquo;ll be exactly <em>k</em> order statistic in sorted array.
Othewise such element should exist in <em>y</em>, if <em>0 &lt;= k &lt; n<sub>1</sub> + n<sub>2</sub></em>.</p>
<p>Here&rsquo;s the code (32 lines):</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">k_order_two_sorted_binsearch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">h</span><span style="color:#000;font-weight:bold">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">l</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">prev_state</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">state</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000">prev_state</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#000">state</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#8f5902;font-style:italic"># is there (l, r) update?    </span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">m</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">l</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">//</span><span style="color:#0000cf;font-weight:bold">2</span>        
</span></span><span style="display:flex;"><span>        <span style="color:#000">pivot</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">f_m</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">m</span> <span style="color:#000;font-weight:bold">],</span> <span style="color:#000">h</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">m</span>              
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">f_m</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#8f5902;font-style:italic"># check boarder cases for f_m values </span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">l</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">m</span>        
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">elif</span> <span style="color:#000">f_m</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">:</span>        
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">m</span> <span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">&gt;=</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">n2</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">]:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">m</span> <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span> 
</span></span><span style="display:flex;"><span>                <span style="color:#000">l</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">m</span> <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">l</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#000">r</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000">r</span>                
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">elif</span> <span style="color:#000">f_m</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">r</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">m</span>                   
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">elif</span> <span style="color:#000">f_m</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">m</span> <span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#0000cf;font-weight:bold">0</span> <span style="color:#000;font-weight:bold">]:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">m</span> <span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">r</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">m</span>                     
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span> <span style="color:#8f5902;font-style:italic"># main part</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">m</span> <span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">&gt;=</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">f_m</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">]</span> <span style="color:#204a87;font-weight:bold">and</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">m</span> <span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">f_m</span> <span style="color:#000;font-weight:bold">]:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">m</span> <span style="color:#000;font-weight:bold">]</span>                
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">elif</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">m</span> <span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">f_m</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#000;font-weight:bold">]:</span>                
</span></span><span style="display:flex;"><span>                <span style="color:#000">l</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">m</span> <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">l</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#000">r</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#204a87;font-weight:bold">else</span> <span style="color:#000">r</span> <span style="color:#8f5902;font-style:italic"># don&#39;t repeat this at home                </span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">elif</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">m</span> <span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">[</span> <span style="color:#000">f_m</span> <span style="color:#000;font-weight:bold">]:</span>    
</span></span><span style="display:flex;"><span>                <span style="color:#000">r</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">m</span>                
</span></span><span style="display:flex;"><span>        <span style="color:#000">prev_state</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">state</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">state</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">l</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">r</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">find_k_order_two_sorted</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">k</span><span style="color:#000;font-weight:bold">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">r</span> <span style="color:#ce5c00;font-weight:bold">:=</span> <span style="color:#000">k_order_two_sorted_binsearch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">k</span> <span style="color:#000;font-weight:bold">):</span>
</span></span><span style="display:flex;"><span>       <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">r</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">k_order_two_sorted_binsearch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">k</span> <span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><p>Before we move to code explanation, I would like to look at this problem from monotonic sequence search view.
<img src="/images/korder_example.svg" alt="korder_table">
Let <em>c[j]</em> be number of elements in y less than <em>x[j]</em>, finally let&rsquo;s look at <em>f[j]-c[j]</em>.
Sequence <em>f</em> is monotonic decreasing (number of elements in <em>y</em> that we need, just <em>k-j</em>), c is non-decreasing, so their difference is also monotonic decreasing.
And by definition zero element in difference sequence corresponds to k order statistic.</p>
<p>Unfortunately, we can&rsquo;t compute <em>f[j]-c[j]</em> in O(1) but luckily we don&rsquo;t need it.
Instead we can compute predicate <em>sign(f[j]-c[j])</em> in constant time, as it was shown in code.
This last observation gives us O(log(n<sub>1</sub>)) complexity for one <em>k_order_two_sorted_binsearch(x, y, &hellip;)</em> call. With symmetrical <em>k_order_two_sorted_binsearch(y, x, &hellip;)</em> call that gives us O(log(n<sub>1</sub>) + log(n<sub>2</sub>)) complexity.</p>
<blockquote>
<p>By the way, <em>f[j]-c[j]</em> can be computed in O(log(n<sub>2</sub>)) and that would give us O(log(n<sub>1</sub>) log(n<sub>2</sub>)), logarithmic-squared complexity, which is <em>not logarithmic enough</em>.</p>
</blockquote>
<p>Let&rsquo;s get back into code. Half of the function <em>k_order_two_sorted_binsearch()</em> is dancing around edge cases for <em>f(m)</em> value. It can be reduced, however I think that code compressing here is not useful for clarity.</p>
<p>This funny line</p>
<pre tabindex="0"><code>l = m if l != r-1 else r
</code></pre><p>is a way to avoid cycle on the last iterations:</p>
<pre tabindex="0"><code>(l, l+1) -&gt; (l, l+1) -&gt; (l+1, l+1)
</code></pre><p>instead of</p>
<pre tabindex="0"><code>(l, l+1) -&gt; (l, l+1) -&gt; (l, l+1) -&gt; ...
</code></pre><p>Let&rsquo;s move back to median. Observation: median is linear function of two k-order statistics: k = floor((n<sub>1</sub>+n<sub>2</sub>-1)/2) and k+1.
Now the solution of median problem will look like:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">median_two_sorted_log</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">n1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">y</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">y</span><span style="color:#000;font-weight:bold">)</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000">lm</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">find_k_order_two_sorted</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">//</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">n1</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#0000cf;font-weight:bold">2</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>       <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">lm</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span>       
</span></span><span style="display:flex;"><span>       <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">lm</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">find_k_order_two_sorted</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span><span style="color:#ce5c00;font-weight:bold">//</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#0000cf;font-weight:bold">2</span>
</span></span></code></pre></div><p>And finally, four logarithmic calls in worst case (even size of merged array and both misses in <em>find_k_order_two_sorted()</em>) isn&rsquo;t very satisfying result for median problem.
If you want more competitive solution you can easily modify <em>k_order_two_sorted_binsearch()</em> in a way it will return k-th and k+1-th order statistics
in one function call.</p>
<blockquote>
<p>It&rsquo;s because when you found <em>x[m]</em> which you are going to return from function the next k+1-th element in merged array would be either <em>x[m+1]</em> or <em>y[f_m]</em>.</p>
</blockquote>
<p>This way the number of logarithmic calls will reduce by factor of two. And such modification ensure complexity O(log(n<sub>1</sub>) + log(n<sub>2</sub>)).
Modified solution look like this:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">median_two_sorted_log_modified</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">n1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">y</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">y</span><span style="color:#000;font-weight:bold">)</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000">lm</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">rm</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">find_k_order_two_sorted_modified</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">//</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">)</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">n1</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">n2</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#0000cf;font-weight:bold">2</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>       <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">lm</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span>       
</span></span><span style="display:flex;"><span>       <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">lm</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">rm</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">/</span> <span style="color:#0000cf;font-weight:bold">2</span>
</span></span></code></pre></div><blockquote>
<p>Code of <em>find_k_order_two_sorted_modified()</em> is very similar to original version.
Try to fix <em>k_order_two_sorted_binsearch()</em> by your own or check out my modified <a href="https://github.com/mihael-tunik/train/blob/master/KOrderTwoSorted/KOrderTwoSortedModified.py">version</a> of code.</p>
</blockquote>
<h2 id="how-good-is-logarithmic-complexity-solution">How good is logarithmic complexity solution?</h2>
<p>Let&rsquo;s do some fair comparison for the median version of the problem.
This is the baseline code:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">merge_two_sorted</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">l</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">m</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">result</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">[]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000">l</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#204a87;font-weight:bold">and</span> <span style="color:#000">m</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">y</span><span style="color:#000;font-weight:bold">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">l</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">&lt;</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">m</span><span style="color:#000;font-weight:bold">]:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">result</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">l</span><span style="color:#000;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">l</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">result</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">y</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">m</span><span style="color:#000;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">m</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#0000cf;font-weight:bold">1</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000">l</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">result</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">l</span><span style="color:#000;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">l</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#0000cf;font-weight:bold">1</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000">m</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">y</span><span style="color:#000;font-weight:bold">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">result</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">y</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">m</span><span style="color:#000;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">m</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">result</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">def</span> <span style="color:#000">median_two_sorted_linear</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">merged</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">merge_two_sorted</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#204a87">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">merged</span><span style="color:#000;font-weight:bold">)</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">%</span> <span style="color:#0000cf;font-weight:bold">2</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">merged</span><span style="color:#000;font-weight:bold">[(</span><span style="color:#000">n</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">//</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">else</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000">merged</span><span style="color:#000;font-weight:bold">[(</span><span style="color:#000">n</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">//</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#000">merged</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">n</span><span style="color:#ce5c00;font-weight:bold">//</span><span style="color:#0000cf;font-weight:bold">2</span><span style="color:#000;font-weight:bold">])</span><span style="color:#ce5c00;font-weight:bold">/</span><span style="color:#0000cf;font-weight:bold">2</span>
</span></span></code></pre></div><p>It computes the median value for two sorted lists in linear time.</p>
<blockquote>
<p>By the way, can you modify this code to O(k)?</p>
</blockquote>
<p>Let&rsquo;s do some tests for random arrays of sizes 30, 50, 100, 150, 200.
Here&rsquo;s results showing boost in performance only growing with array size.
<img src="/images/performance.svg" alt="Integer labeling"></p>
<h2 id="instead-of-conclusion">Instead of conclusion</h2>
<p>In this small article we investigated nice solution of MedianTwoSorted problem.
Moreover generalized version of the problem (with k order statistic instead of median) has been solved by original algorithm.
You can find full code <a href="https://github.com/mihael-tunik/train/tree/master/KOrderTwoSorted">here</a>.</p>
        </div>
    </article>
</div>
            <footer class="footer">    
    <p>⚡️ Blog powered by <a href="https://gohugo.io/" target="_blank">Hugo</a>. Using <a href="https://github.com/sergiobarriel/tophat-theme" target="_blank">Top Hat</a> theme.</p>
</footer>
        </div>
    </body>
</html>