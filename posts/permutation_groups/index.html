<!doctype html>
<html lang="en">
    <head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content='text/html; charset=utf-8' http-equiv='content-type' />
<meta name="generator" content="Hugo 0.140.2">
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bitter&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://mihael-tunik.github.io/css/styles.css" rel="stylesheet">
<title>MT mini-blog</title>
<meta name="description" content="In mathematics, when you change the order of elements in some collection it is called a permutation.
You can &ldquo;multiply&rdquo; permutations by taking their composition and for given permutation you can always find inverse one which simply reverses its action.
And also we can imagine identity permutation which does nothing with order of elements.
This means permutations can form a very special algebraic structures, groups (remember, compositions are associative).
Such permutation groups has been studied a lot and there&rsquo;s a whole world of algorithms around them.
In this article we&rsquo;ll look at Sims-Schreier algorithm in context of group order computation and in the end I&rsquo;ll show a fun way to represent Rubick&rsquo;s cube.
Let&rsquo;s dive in!">
<meta name="author" content="">


<meta property="og:description" content="In mathematics, when you change the order of elements in some collection it is called a permutation.
You can &ldquo;multiply&rdquo; permutations by taking their composition and for given permutation you can always find inverse one which simply reverses its action.
And also we can imagine identity permutation which does nothing with order of elements.
This means permutations can form a very special algebraic structures, groups (remember, compositions are associative).
Such permutation groups has been studied a lot and there&rsquo;s a whole world of algorithms around them.
In this article we&rsquo;ll look at Sims-Schreier algorithm in context of group order computation and in the end I&rsquo;ll show a fun way to represent Rubick&rsquo;s cube.
Let&rsquo;s dive in!" />







<meta name="twitter:description" content="In mathematics, when you change the order of elements in some collection it is called a permutation.
You can &ldquo;multiply&rdquo; permutations by taking their composition and for given permutation you can always find inverse one which simply reverses its action.
And also we can imagine identity permutation which does nothing with order of elements.
This means permutations can form a very special algebraic structures, groups (remember, compositions are associative).
Such permutation groups has been studied a lot and there&rsquo;s a whole world of algorithms around them.
In this article we&rsquo;ll look at Sims-Schreier algorithm in context of group order computation and in the end I&rsquo;ll show a fun way to represent Rubick&rsquo;s cube.
Let&rsquo;s dive in!">


</head>
    <body>
        <div class="content">
            <nav class="blog-navigation">
  <div class="left">
      <div class="blog-logo">
        <a href='/' title="MT mini-blog">
          <img src="https://mihael-tunik.github.io/img/logo.svg" alt="MT mini-blog">
        </a>
      </div>
      <div class="blog-info">
          <div class="blog-title">
            <a href='/' title="MT mini-blog">
              <h1>MT mini-blog</h1>
            </a>
          </div>
          <div class="blog-description">
            <a href='/' title="MT mini-blog">
              <h2>Things around computer science</h2>
            </a>
          </div>
      </div>
  </div>
  <div class="right">
    <div class="blog-links">
      <ul class="links">
          <li class="item page"><a href='/pages/about/' title="About">About</a></li><li class="item page"><a href='/uploads/cv_en.pdf' title="CV">CV</a></li>
          <li class="item social"><a href='https://github.com/mihael-tunik' title="Github" target="_blank">Github</a></li>
      </ul>
    </div>
  </div>
</nav>
<div class="single">
    <article>
        <div class="article-meta">
    <ul class="article-info">
        <li class="time" style="">
            <time class="time">16 Aug 2024</time>
        </li>
        <li class="reading-time" style="">
            <span class="material-icons">timer</span>8 min read
        </li>
        <li class="words-count" style="">
            <span class="material-icons">article</span>1629 words
        </li>
    </ul>
    <ul class="article-tags" style="">
                <li>
                    <a href='/tags/algorithms'>#algorithms</a>
                </li>
                <li>
                    <a href='/tags/mathematics'>#mathematics</a>
                </li>
                <li>
                    <a href='/tags/python'>#python</a>
                </li>
    </ul>
</div>
        <div class="article-header">
            <h1 class="article-title">Permutation groups and Sims-Schreier algorithm</h1>          
            <h2 class="article-excerpt"></h2>  
        </div>
        <div class="article-content">
            <p>In mathematics, when you change the order of elements in some collection it is called a permutation.
You can &ldquo;multiply&rdquo; permutations by taking their composition and for given permutation you can always find inverse one which simply reverses its action.
And also we can imagine identity permutation which does nothing with order of elements.
This means permutations can form a very special algebraic structures, groups (remember, compositions are associative).
Such permutation groups has been studied a lot and there&rsquo;s a whole world of algorithms around them.
In this article we&rsquo;ll look at Sims-Schreier algorithm in context of group order computation and in the end I&rsquo;ll show a fun way to represent Rubick&rsquo;s cube.
Let&rsquo;s dive in!</p>
<h2 id="introduction">Introduction</h2>
<p>First let&rsquo;s define basic operations with permutations.
Permutations are stored coordinatewise:
<em>x({1, &hellip;, n}) = {x<sub>1</sub>(1), &hellip;, x<sub>n</sub>(n)}</em>.
With multiplication let&rsquo;s follow rightmost first notation, which means that it&rsquo;s viewed as composition from right to left.</p>
<blockquote>
<p>For <em>Q = {1, &hellip;, n}</em> we define <em>x * y = x(y(Q))</em>.
Then inverse is defined as permutation <em>x<sub>inv</sub></em> such as <em>x(x<sub>inv</sub>(Q)) = Q</em> or <em>x * x<sub>inv</sub> = identity</em>.</p>
</blockquote>
<p>Here&rsquo;s the code:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000">def</span> <span style="color:#000">mult</span><span style="color:#000;font-weight:bold">(</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">p_chain</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">res</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#000">in</span> <span style="color:#000">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">p_chain</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">]))</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">image</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">i</span>
</span></span><span style="display:flex;"><span>        <span style="color:#8f5902;font-style:italic"># x o y = x(y(S)), rightmost first
</span></span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"></span>        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">p</span> <span style="color:#000">in</span> <span style="color:#000">reversed</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">p_chain</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span> 
</span></span><span style="display:flex;"><span>            <span style="color:#000">image</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">p</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">image</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#000">res</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">append</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">image</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">tuple</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">res</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#000">def</span> <span style="color:#000">inv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">res</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">list</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">deepcopy</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#000">in</span> <span style="color:#000">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">))</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">res</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">x</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">tuple</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">res</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><h2 id="group-order">Group order</h2>
<p>Requirement: before reading this article make sure that you have some basic understanding of group theory: what is <em>group</em>, <em>group operation</em>, <em>subgroup</em>.
I&rsquo;ll give some definitions later, but it may be better to get this knowledge from well-structured learning book about group theory.</p>
<p>Every set of permutations generate some group, minimal set of permutations which contains starting permutations and closed under multiplication.
Starting permutations called <em>generators</em>, if <em>G</em> generated by set <em>S</em> it can written as <em>G = 〈 S 〉</em>.</p>
<blockquote>
<p>Algorithm for group generation is straightforward:
start from generating set, then multiply permutations with each other and append new elements until new ones will stop to appear.</p>
</blockquote>
<p>This can be rewritten as depth-first search. Start from identity permutation and explore group as graph:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000">def</span> <span style="color:#000">BuildGroupDfs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">p</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">S</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">group</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">g</span> <span style="color:#000">in</span> <span style="color:#f57900">S</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">h</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">mult</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">g</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">p</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">h</span> <span style="color:#000">not</span> <span style="color:#000">in</span> <span style="color:#f57900">group</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">group</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">h</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">BuildGroupDfs</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">h</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">S</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">group</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><p>Size of group is called <em>group order</em> (written as <em>|G|</em>).
Often we want to know order of the group generated by some permutations without enumerating its elements
because in practice resultings groups are often expected to be huge. In such a case Sims-Schreier algorithm comes in handy.</p>
<blockquote>
<p>By the way, tree of recursive calls here can degenerate to long chain. Build an example.</p>
</blockquote>
<h2 id="basic-definitions">Basic definitions</h2>
<p>Before we start we need to define most fundamental things in group theory.</p>
<p>First, group <em>H</em> is called <em>subgroup</em> of the group <em>G</em> if its elements are subset of elements of <em>G</em>, let&rsquo;s write it <em>H ≤ G</em>.</p>
<p><em>Orbit</em> of element <em>q ∈ Q</em> and group <em>G</em> is subset of Q that for every <em>q<sub>o</sub> ∈ Orb(q)</em> there&rsquo;s <em>g ∈ G: q<sub>o</sub> = g(q)</em>.
In other words it&rsquo;s just possible positions where <em>G</em> can &ldquo;move&rdquo; our element <em>q</em>.</p>
<p><em>Stabilizer</em> subgroup of <em>G</em> and element <em>q</em> is <em>subgroup</em> which leaves element <em>q</em> fixed on the place.
Definition can look like this: <em>Stab(G, q) ≤ G and h(q)=q</em> for every <em>h ∈ H</em>.</p>
<p>Now, let&rsquo;s define <em>cosets</em>:</p>
<ul>
<li>for subgroup <em>H ≤ G</em> and <em>g ∈ G</em> <em>right</em> coset <em>Hg</em> is set of elements <em>h * g</em> and <em>h ∈ H</em>;</li>
<li>for subgroup <em>H ≤ G</em> and <em>g ∈ G</em> <em>left</em> coset <em>gH</em> is set of elements <em>g * h</em> and <em>h ∈ H</em>.</li>
</ul>
<p>Every <em>g ∈ G</em> is contained in exactly one coset.
You can think about cosets as about <em>partition</em> of elements of <em>G</em>.</p>
<p>And probably the most tricky thing in Sims-Schreier algorithm is <em>transversal</em>.
Let&rsquo;s define it as system of representative elements of each coset of some subgroup <em>H ≤ G</em> (including identity element).</p>
<blockquote>
<p>Transversals are just permutations, which have been chosen by special rule.
Sounds simple, but it requires me some time to get it when I was reading about Sims-Schreier first time.</p>
</blockquote>
<p>Now we are ready.</p>
<h2 id="sims-schreier-algorithm">Sims-Schreier algorithm</h2>
<p>Main idea of Sims-Schreier algorithm is to decompose our group <em>G</em> into the <em>chain of subgroups</em>.
It means that each group in chain <em>G<sub>i</sub></em> should be a subgroup of previous one <em>G<sub>i-1</sub></em>:</p>
<blockquote>
<p><em>G = G<sub>0</sub> ≥ G<sub>1</sub> ≥ &hellip; ≥ G<sub>n</sub> = 〈 identity 〉</em>.</p>
</blockquote>
<p>For such chain it can be proved that every element <em>g ∈ G</em> has <em>unique</em> representation as product of right transversals <em>R<sub>i</sub></em> of <em>G<sub>i</sub> ≤ G<sub>i-1</sub></em>:</p>
<blockquote>
<p><em>g = r<sub>1</sub> * r<sub>2</sub> &hellip; * r<sub>n</sub></em> for <em>r<sub>1</sub> ∈ R<sub>1</sub>, r<sub>2</sub> ∈ R<sub>2</sub>, &hellip;, r<sub>n</sub> ∈ R<sub>n</sub>.</em></p>
</blockquote>
<p>Start from observation that for subgroup <em>H ≤ G</em>, cosets partition and chosen transversals it is true that
every <em>g ∈ G</em> can be uniquely expressed as <em>g = t<sub>Hg</sub> h</em>. Repeat same reasoning for subgroup of <em>H</em>.</p>
<p>This logic works for every chain of subgroups, however for efficient computations we need <em>stabilizer subgroups</em> in our chain.
It is because in such a case we can use Schreier lemma which will be discussed later.</p>
<p>Ok, since transversal representation is unique it is now easy to see that the order of <em>G</em> is the product of <em>|R<sub>i</sub>|</em>.</p>
<blockquote>
<p>By iterating through every <em>R<sub>i</sub></em> it&rsquo;s easy to list elements of <em>G</em> without repetition.
There&rsquo;s also a way to return random <em>g ∈ G</em> by picking transversals randomly.</p>
</blockquote>
<p>Let&rsquo;s get back to stabilizer chain and technical details.</p>
<ul>
<li>How to compute transversals?</li>
</ul>
<p>First we need to answer a question:
if we have a stabilizer <em>G<sub>u</sub></em> what is the structure of cosets <em>G<sub>u</sub> ≤ G</em>?</p>
<p>The answer is that different cosets correspond to different mappings <em>u ∈ Q</em> to <em>v ∈ Q</em> possible for group <em>G</em>.
For example coset containing elements of <em>G<sub>u</sub></em> will contain mapping from <em>u</em> to <em>u</em>.
Therefore there&rsquo;s natural bijection between point orbit elements and cosets.
This is enough to compute every transversal. For given generator set compute set of permutations for every possible mapping.
This can be made in dfs-like fashion and corresponding tree is called <em>Schreier Tree</em>.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#000">def</span> <span style="color:#000">BuildSchreierTree</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">S</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">g</span> <span style="color:#000">in</span> <span style="color:#f57900">S</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">g</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#000">not</span> <span style="color:#000">in</span> <span style="color:#f57900">orbit</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">g</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">mult</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">g</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">BuildSchreierTree</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">g</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">],</span> <span style="color:#000">S</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><ul>
<li>How to compute stabilizer subgroup?
Use <em>Schreier lemma</em> to compute generators of subgroups.</li>
</ul>
<blockquote>
<p>For <em>G = 〈 S 〉</em> and <em>u ∈ Q, p ∈ Q</em> let <em>R</em> be right transversal for cosets <em>G<sub>u</sub> ≤ G</em> and let <em>r<sub>p</sub> ∈ R</em> be transversal element mapping <em>u</em> to <em>p</em>.
Then stabilizer subgroup <em>G<sub>u</sub></em> is generated by the following set <em>{r<sub>s(p)</sub><sup>-1</sup> s r<sub>p</sub>, for p ∈ u<sup>G</sup> and s ∈ S}</em> called <em>Schreier generators</em>.</p>
</blockquote>
<p>This is <em>Schreier lemma</em> for stabilizers.</p>
<blockquote>
<p>Note: <em>r<sub>s(p)</sub><sup>-1</sup> s r<sub>p</sub></em> in <em>rightmost-first</em> notation, compare with standard <em>r<sub>p</sub> s r<sub>s(p)</sub><sup>-1</sup></em> in <em>leftmost-first</em> notation.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span><span style="color:#000">def</span> <span style="color:#000">BuildSchreierGenerators</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">S</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">S_gen</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">set</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">g</span> <span style="color:#000">in</span> <span style="color:#f57900">S</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">u</span> <span style="color:#000">in</span> <span style="color:#f57900">orbit</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">schreier_generator</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">mult</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">g</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">u</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]]),</span> <span style="color:#000">g</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">u</span><span style="color:#000;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">S_gen</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">schreier_generator</span><span style="color:#000;font-weight:bold">)</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">S_gen</span>
</span></span></code></pre></div><p>After orbit is computed and generators are found this new generator set can be much larger then previous one.
At the same time many of Schreier generators often turns out to be redundant, that means there exists smaller set of generators for the same group.
This will cause unnecessary combinatorial growth unless new set will be filtered by some procedure.</p>
<p>Sims filter is the best option here, it guarantees resulting set to be O(|Q|<sup>2</sup>) in size. Main idea of this algorithm to construct
generating set including only one permutation for every pair <em>(i, j)</em> which maps <em>i</em> to <em>j</em> in Gauss-elimination style.</p>
<p>Here&rsquo;s my modified Python version of this algorithm based on the code from internet article and Charles Sims survey.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span><span style="color:#000">def</span> <span style="color:#000">SimsFilter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">S</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000">u</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[[</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">*</span><span style="color:#000">n</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">n</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a40000">#</span> <span style="color:#000">only</span> <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#000">i</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">g</span> <span style="color:#000">in</span> <span style="color:#f57900">S</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">h</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">g</span>        
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#000">in</span> <span style="color:#000">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">h</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">j</span> <span style="color:#ce5c00;font-weight:bold">&gt;</span> <span style="color:#f57900">i</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">u</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">==</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000">u</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">h</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#204a87;font-weight:bold">break</span>
</span></span><span style="display:flex;"><span>                <span style="color:#204a87;font-weight:bold">else</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000">h</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">mult</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">inv</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">u</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">]),</span> <span style="color:#000">h</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000">S_reduced</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">set</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">i</span> <span style="color:#000">in</span> <span style="color:#000">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">j</span> <span style="color:#000">in</span> <span style="color:#000">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#204a87;font-weight:bold">if</span> <span style="color:#000">u</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000">S_reduced</span><span style="color:#000;font-weight:bold">.</span><span style="color:#000">add</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">u</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">][</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">S_reduced</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#000">def</span> <span style="color:#000">SchreierSims</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">S</span><span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000">n</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">S</span><span style="color:#000;font-weight:bold">[</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">])</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000">ans</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">group_order</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[],</span> <span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">while</span> <span style="color:#000">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">S</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">!=</span> <span style="color:#0000cf;font-weight:bold">0</span> <span style="color:#000">and</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">&lt;=</span> <span style="color:#f57900">n</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">orbit</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#f57900">i</span> <span style="color:#000;font-weight:bold">:</span> <span style="color:#000">tuple</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">range</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">n</span><span style="color:#ce5c00;font-weight:bold">+</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">))}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">BuildSchreierTree</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">i</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">S</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>       
</span></span><span style="display:flex;"><span>        <span style="color:#000">R</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">[</span><span style="color:#000">j</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#000">j</span> <span style="color:#000">in</span> <span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">S</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">SimsFilter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">BuildSchreierGenerators</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">S</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">orbit</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">n</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#000">ans</span> <span style="color:#ce5c00;font-weight:bold">+=</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#000">R</span><span style="color:#000;font-weight:bold">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000">group_order</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">group_order</span> <span style="color:#ce5c00;font-weight:bold">*</span> <span style="color:#000">len</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">R</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">i</span> <span style="color:#ce5c00;font-weight:bold">+</span> <span style="color:#0000cf;font-weight:bold">1</span> 
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#204a87;font-weight:bold">return</span> <span style="color:#000">ans</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">group_order</span>
</span></span></code></pre></div><p>You can find full code <a href="https://github.com/mihael-tunik/train/tree/master/PermutationGroups">here</a>.</p>
<h2 id="instead-of-conclusion">Instead of conclusion</h2>
<p>Recently, I came across this nice way to represent Rubick&rsquo;s cubes as planar graphs (left on the picture and cube net is shown for comparison).
<img src="/images/cube2x2_id.svg" alt="cube2x2_id">
This representation is very helpful for understanding which permutations are equivalent to cube rotations.
<img src="/images/cube2x2_r1.svg" alt="cube2x2_r1">
Note, for this scheme there&rsquo;s two &ldquo;different&rdquo; types of possible rotations. There&rsquo;s <em>inner rotation</em> and <em>outer rotation</em>.
They are coincide (up to enumeration) with each other and different only on the picture.</p>
<p>It&rsquo;s easy to see that corresponding to pictures generating permutations are</p>
<pre tabindex="0"><code>[[1 , 13, 9, 3 , 23, 6 , 7 , 14, 10, 4 , 24, 12, 11, 5 , 15, 16, 17, 18, 19, 20, 21, 22, 8 , 2 ],
 [1 , 2 , 3, 14, 11, 5 , 7 , 8 , 9 , 16, 12, 6 , 13, 18, 15, 20, 17, 22, 19, 24, 21, 4 , 23, 10],
 [22, 2 , 3, 4 , 5 , 16, 21, 8 , 9 , 10, 11, 15, 13, 14, 1 , 7 , 19, 17, 20, 18, 6 , 12, 23, 24]]
</code></pre><p>For 2x2 version of Rubick&rsquo;s cube they are enough to generate whole permutation group.
Let&rsquo;s check our algorithm:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;&gt;</span> <span style="color:#000">R</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">group_order</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">SchreierSims</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">generators</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;&gt;</span> <span style="color:#000">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">group_order</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">&gt;&gt;&gt;</span> <span style="color:#0000cf;font-weight:bold">88179840</span>
</span></span></code></pre></div><p>This number coincides with known <a href="https://oeis.org/A054434">results</a>.</p>
        </div>
    </article>
</div>
            <footer class="footer">    
    <p>⚡️ Blog powered by <a href="https://gohugo.io/" target="_blank">Hugo</a>. Using <a href="https://github.com/sergiobarriel/tophat-theme" target="_blank">Top Hat</a> theme.</p>
</footer>
        </div>
    </body>
</html>