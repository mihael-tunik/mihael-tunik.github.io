<!doctype html>
<html lang="en">
    <head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content='text/html; charset=utf-8' http-equiv='content-type' />
<meta name="generator" content="Hugo 0.140.1">
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bitter&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://mihael-tunik.github.io/css/styles.css" rel="stylesheet">
<title>MT mini-blog</title>
<meta name="description" content="Counting inversions in O(n log n) is infamous algorithmic question with divide and conquer solution.
However, did you know that there exists a family of algorithms to solve the it with same asymptotics? Let&rsquo;s find out!">
<meta name="author" content="">


<meta property="og:description" content="Counting inversions in O(n log n) is infamous algorithmic question with divide and conquer solution.
However, did you know that there exists a family of algorithms to solve the it with same asymptotics? Let&rsquo;s find out!" />







<meta name="twitter:description" content="Counting inversions in O(n log n) is infamous algorithmic question with divide and conquer solution.
However, did you know that there exists a family of algorithms to solve the it with same asymptotics? Let&rsquo;s find out!">


</head>
    <body>
        <div class="content">
            <nav class="blog-navigation">
  <div class="left">
      <div class="blog-logo">
        <a href='/' title="MT mini-blog">
          <img src="https://mihael-tunik.github.io/img/logo.svg" alt="MT mini-blog">
        </a>
      </div>
      <div class="blog-info">
          <div class="blog-title">
            <a href='/' title="MT mini-blog">
              <h1>MT mini-blog</h1>
            </a>
          </div>
          <div class="blog-description">
            <a href='/' title="MT mini-blog">
              <h2>Things around computer science</h2>
            </a>
          </div>
      </div>
  </div>
  <div class="right">
    <div class="blog-links">
      <ul class="links">
          <li class="item page"><a href='/pages/about/' title="About">About</a></li>
          <li class="item social"><a href='https://github.com/mihael-tunik' title="Github" target="_blank">Github</a></li>
      </ul>
    </div>
  </div>
</nav>
<div class="single">
    <article>
        <div class="article-meta">
    <ul class="article-info">
        <li class="time" style="">
            <time class="time">26 Dec 2024</time>
        </li>
        <li class="reading-time" style="">
            <span class="material-icons">timer</span>1 min read
        </li>
        <li class="words-count" style="">
            <span class="material-icons">article</span>201 words
        </li>
    </ul>
    <ul class="article-tags" style="">
                <li>
                    <a href='/tags/algorithms'>#algorithms</a>
                </li>
                <li>
                    <a href='/tags/medium'>#medium</a>
                </li>
                <li>
                    <a href='/tags/tutorials'>#tutorials</a>
                </li>
                <li>
                    <a href='/tags/python'>#python</a>
                </li>
    </ul>
</div>
        <div class="article-header">
            <h1 class="article-title">Count inversions with Fenwick trees</h1>          
            <h2 class="article-excerpt"></h2>  
        </div>
        <div class="article-content">
            <p>Counting inversions in O(n log n) is infamous algorithmic question with divide and conquer solution.
However, did you know that there exists a family of algorithms to solve the it with same asymptotics? Let&rsquo;s find out!</p>
<h2 id="inversions">Inversions</h2>
<p>Let <em>a</em> be our array and <em>i, j</em> indexes.
By definition number of inversions is number of pairs (i, j) for which following predicate is true
<em>a[i] &gt; a[j]</em> and <em>i &lt; j</em>. Simple quadratic algorithm can be easily constructed:</p>
<pre tabindex="0"><code>def inversions_base(a):
    n, cnt = len(a), 0
    for i in range(0, n):
        for j in range(0, n):
            if a[i] &gt; a[j] and i &lt; j:
                cnt += 1
    return cnt
</code></pre><p>How to progress from it? First we need to reformulate counting task in terms of <em>flag array</em>.</p>
<pre tabindex="0"><code>def inversions_flag_array(a):
    n, cnt, M = len(a), 0, max(a) 
    T = [0] * (M + 1)
    for i in range(0, n):
        T[a[i]] = 1
        for j in range(a[i] + 1, M+1):
            cnt += T[j]
    return cnt
</code></pre><p>Then we can make queries like sum on interval efficiently with little help of data structures.
TODO &hellip;</p>
<h2 id="instead-of-conclusion">Instead of conclusion</h2>
<p>In this small article we investigated nice solution of counting inversions in array problem.
You can find full code <a href="https://github.com/mihael-tunik/train/tree/master/InversionsNumber">here</a>.</p>
        </div>
    </article>
</div>
            <footer class="footer">    
    <p>⚡️ Blog powered by <a href="https://gohugo.io/" target="_blank">Hugo</a>. Using <a href="https://github.com/sergiobarriel/tophat-theme" target="_blank">Top Hat</a> theme.</p>
</footer>
        </div>
    </body>
</html>